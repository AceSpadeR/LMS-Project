@page
@model ProfilePicModel
@{
    ViewData["Title"] = "ProfileImage";
}
<h1>Profile Image</h1>
<hr />

<div class="row">
    <div class="col-lg-6 d-flex align-items-center justify-content-center">
        @if (Model.ImageData == null)
        {
            <img class="profile-img" src="@Url.Content("~/ProfilePic/default-profile.jpg")" alt="image" />
        }
        else
        {
            <img class="profile-img" src="data:image/png;base64,@Convert.ToBase64String(Model.ImageData)" alt="image" />
        }
    </div>
    <div class="col-lg-6">
        <form action="" method="post" enctype="multipart/form-data" style="padding-top: 100px;">
            <input type="hidden" asp-for="User.Id" />
            <div class="form-group">
                <h5>Upload Image<i class="bi bi-image ms-2"></i></h5>
                <div class="d-flex">
                    <input type="file" name="Image" class="form-control" onchange="validateFileInput()" accept="image/*" />
                    <button type="submit" class="btn btn-primary d-flex align-items-center" id="uploadButton" disabled>
                        <i class="bi bi-file-earmark-arrow-up me-2"></i> Upload
                    </button>
                </div>
            </div>
            <div class="mt-3">
                <a asp-page="./Profile" class="btn btn-primary">
                    <i class="bi bi-arrow-left me-2"></i> Back to Profile
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts
{
    <script>
        function validateFileInput() {
            var fileInput = document.querySelector('input[type="file"]');
            var uploadButton = document.getElementById('uploadButton');

            // Check if file is selected and if it's an image
            if (fileInput.files && fileInput.files.length === 1) {
                var fileType = fileInput.files[0].type;
                if (fileType.startsWith('image/')) {
                    // Enable button if one image file is selected
                    uploadButton.disabled = false;
                    return;
                }
            }

            // Disable button if no file is selected or if more than one file is selected or if it's not an image
            uploadButton.disabled = true;
        }
    </script>
}
